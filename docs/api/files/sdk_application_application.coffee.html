<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>sdk/application/application.coffee - WeatherSoapApp</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="WeatherSoapApp"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AggregateCollection.html">AggregateCollection</a></li>
            
                <li><a href="../classes/Application.html">Application</a></li>
            
                <li><a href="../classes/Authentication.html">Authentication</a></li>
            
                <li><a href="../classes/Authorization.html">Authorization</a></li>
            
                <li><a href="../classes/Base64.html">Base64</a></li>
            
                <li><a href="../classes/BelongsTo.html">BelongsTo</a></li>
            
                <li><a href="../classes/Collection.html">Collection</a></li>
            
                <li><a href="../classes/Collections.html">Collections</a></li>
            
                <li><a href="../classes/Cookie.html">Cookie</a></li>
            
                <li><a href="../classes/HasMany.html">HasMany</a></li>
            
                <li><a href="../classes/HasOne.html">HasOne</a></li>
            
                <li><a href="../classes/MockServer.html">MockServer</a></li>
            
                <li><a href="../classes/Model.html">Model</a></li>
            
                <li><a href="../classes/Models.html">Models</a></li>
            
                <li><a href="../classes/Relationship.html">Relationship</a></li>
            
                <li><a href="../classes/ScopeCollection.html">ScopeCollection</a></li>
            
                <li><a href="../classes/Url.html">Url</a></li>
            
                <li><a href="../classes/Validator.html">Validator</a></li>
            
                <li><a href="../classes/WeatherByZip.html">WeatherByZip</a></li>
            
                <li><a href="../classes/WeatherByZipAll.html">WeatherByZipAll</a></li>
            
                <li><a href="../classes/WeatherByZipCount.html">WeatherByZipCount</a></li>
            
                <li><a href="../classes/WeatherByZipCountExactMatch.html">WeatherByZipCountExactMatch</a></li>
            
                <li><a href="../classes/WeatherByZipExactMatch.html">WeatherByZipExactMatch</a></li>
            
                <li><a href="../classes/WeatherSoapAppSdk.html">WeatherSoapAppSdk</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/AP.html">AP</a></li>
            
                <li><a href="../modules/auth.html">auth</a></li>
            
                <li><a href="../modules/collection.html">collection</a></li>
            
                <li><a href="../modules/collections.html">collections</a></li>
            
                <li><a href="../modules/MockServer.html">MockServer</a></li>
            
                <li><a href="../modules/model.html">model</a></li>
            
                <li><a href="../modules/models.html">models</a></li>
            
                <li><a href="../modules/relationship.html">relationship</a></li>
            
                <li><a href="../modules/utility.html">utility</a></li>
            
                <li><a href="../modules/WeatherSoapAppSdk.html">WeatherSoapAppSdk</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: sdk/application/application.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
###*
Provides convenience methods common to apps.  Generally, apps are
namespaces not intended for instantiation.

All apps should inherit from this class and execute setup.  It is important to
execute setup before adding members.

For example (Coffeescript):
@example
    class AppClass extends AP.Application
      @setup()

@module AP
@class Application
@static
###
class AP.Application
  ###*
  Adds static members to the class:
  
  - &#x60;name&#x60;
  - &#x60;description&#x60;
  - &#x60;models&#x60;
  - &#x60;collections&#x60;
  
  It is important to execute setup before adding members.
  @method setup
  @static
  ###
  @setup: -&gt;
    @name = @name or &#x27;&#x27;
    @description = @description or &#x27;&#x27;
    @models = {}
    @collections = {}
    @mockServer = null
  
  ###*
  @method init
  @static
  ###
  @init: -&gt;
    AP = window.AP
    @mockServer = new AP.utility.MockServer(@) if AP.useMockServer
    @initOfflineCache() if AP.useOfflineCache
    @initAjaxSetup()
  
  ###*
  @method initOfflineCache
  @static
  ###
  @initOfflineCache: -&gt;
    AP = window.AP
    AP.offlineDataStore = new AP.utility.TransientLargeLocalStore
      storageName: &#x27;ap-offline-data-store&#x27;
      storageCapacity: AP.offlineStorageCapacity
    Backbone._sync = Backbone.sync
    Backbone.sync = (method, obj, options) -&gt;
      url = options.url or _.result obj, &#x27;url&#x27;
      # cache only on GET
      if url and method == &#x27;read&#x27;
        data = options.data or JSON.stringify(options.attrs or obj?.toJSON options)
        oldSuccess = options.success
        oldError = options.error
        # build cache key
        user = null
        if AP.auth.Authentication.isAuthenticated()
          user =
            username: AP.auth.Authentication.getUsername()
            role: AP.auth.Authentication.getUserRole()
        cacheKey = [AP.baseUrl, url, data, user]
        # override success and error callbacks to handle caching
        options.success = (response) =&gt;
          AP.offlineDataStore.set cacheKey, response
          oldSuccess.apply @, arguments
        options.error = (xhr) =&gt;
          status = +xhr.status
          if status &lt; 400 or status &gt;=500
            AP.offlineDataStore.get cacheKey,
              success: (cached) =&gt; oldSuccess.apply @, [cached]
              error: =&gt; oldError.apply @, arguments
          else
            oldError.apply @, arguments
      Backbone._sync.apply @, arguments
  
  ###*
  @method initAjaxSetup
  @static
  ###
  @initAjaxSetup: -&gt;
    AP = window.AP
    $.ajaxSetup
      beforeSend: (request, settings) -&gt;
        baseUrl = AP.utility.Url.parseUrl AP.baseUrl
        requestUrl = AP.utility.Url.parseUrl settings.url
        hasNoRequestServer = !(requestUrl.host and requestUrl.protocol)
        isRequestUrlSameAsBaseUrlServer =
          (
            (baseUrl.protocol == requestUrl.protocol) and
            (baseUrl.host == requestUrl.host) and
            (baseUrl.port == requestUrl.port)
          ) or hasNoRequestServer
        if isRequestUrlSameAsBaseUrlServer
          # send the session ID with the deauthentication request
          authSessionIdHeader = AP.auth.Authentication.getAuthSessionIdHeaderName()
          authSessionId = AP.auth.Authentication.getAuthSessionId()
          request.setRequestHeader(authSessionIdHeader, authSessionId) if authSessionId
        # point the request to the proper server
        if !AP.useMockServer and AP.baseUrl and hasNoRequestServer
          # if no host or protocol, add the base URL
          _.extend settings,
            crossDomain: true
            url: &quot;#{AP.baseUrl}#{settings.url}&quot;
            xhrFields: _.extend {}, settings.xhrFields, {withCredentials: true}
  
  ###*
  @method proxy
  @static
  ###
  @proxy: (fn) -&gt; (=&gt; fn.apply @, arguments)
  
  ###*
  Returns a model class for this application by name or model ID.
  @method getModel
  @static
  @param {String} str the name or ID of a model
  @return {AP.model.Model} a model class
  ###
  @getModel: (str) -&gt;
    _.find @models, (val, key) -&gt; key == str or val.modelId == str or val.name == str
  
  ###*
  Returns a collection class for this application by name or collection ID.
  @param {String} str the name or ID of a collection
  @return {AP.collection.Collection} a collection class
  @method getCollection
  @static
  ###
  @getCollection: (str) -&gt;
    _.find @collections, (val, key) -&gt; key == str or val.collectionId == str or val.name == str

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
